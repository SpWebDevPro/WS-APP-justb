{"version":3,"sources":["../../lib/assets/javascripts/os-time.js","../../lib/assets/javascripts/os-shared.js","../../lib/assets/javascripts/os-notifications.js","../../lib/assets/javascripts/os-actions.js","../../lib/assets/javascripts/main_front.js","../../lib/assets/javascripts/os-payments-braintree.js","../../lib/assets/javascripts/os-payments-paypal.js"],"names":["latepoint_is_timeframe_in_periods","timeframe_start","timeframe_end","periods_arr","is_inside","arguments","length","undefined","i","period_start","period_end","buffer_before","buffer_after","period_info","split","parseFloat","latepoint_is_period_inside_another","latepoint_is_period_overlapping","period_one_start","period_one_end","period_two_start","period_two_end","latepoint_minutes_to_hours_preferably","time","army_clock","latepoint_is_army_clock","hours","Math","floor","minutes","latepoint_minutes_to_hours","latepoint_am_or_pm","latepoint_hours_and_minutes_to_minutes","hours_and_minutes","ampm","hours_and_minutes_arr","parseInt","latepoint_get_time_system","latepoint_helper","time_system","latepoint_minutes_to_hours_and_minutes","format","sprintf","latepoint_mask_timefield","$elem","jQuery","inputmask","mask","placeholder","latepoint_mask_phone","latepoint_is_phone_masking_enabled","latepoint_get_phone_format","phone_format","enable_phone_masking","latepoint_show_booking_end_time","show_booking_end_time","latepoint_init_form_masks","latepoint_get_paypal_payment_amount","$booking_form_wrapper","payment_portion","payment_amount","find","val","data","latepoint_add_notification","message","message_type","wrapper","append","remove","latepoint_generate_form_message_html","messages","status","message_html","Array","isArray","forEach","latepoint_clear_form_messages","$form","latepoint_show_data_in_lightbox","extra_classes","lightbox_css_classes","addClass","latepoint_apply_coupon","closest","$coupon_input","form_params","serialize","action","route_name","params","layout","return_format","ajax","type","dataType","url","ajaxurl","success","removeClass","latepoint_show_message_inside_element","latepoint_reload_step","latepoint_coupon_removed","fadeOut","submit","latepoint_get_new_prev_payment_class","$payment_step","new_current_payment_step_class","new_prev_payment_step_class","latepoint_reset_password_from_booking_init","hide","on","html","show","latepoint_update_summary_field","field_name","value","$summary_holder","String","trim","text","hasClass","slideDown","fadeIn","slideUp","latepoint_password_changed_show_login","response","latepoint_hide_message_inside_element","prepend","latepoint_clear_step_vars","step_name","latepoint_set_payment_token_and_submit","token","$booking_form","document","ready","$","e","$this","this","confirm","location","reload","window","replace","before","after","func_name","alert","preventDefault","form_data","record_id","form_values_to_update","each","name","documentElement","body","animate","scrollTop","offset","top","OsPaymentsBraintree","button","braintree","client","create","authorization","braintree_paypal_client_auth","then","clientInstance","paypalCheckout","paypalCheckoutInstance","paypal","Button","render","style","label","size","shape","tagline","color","env","braintree_paypal_environment_name","payment","createPayment","flow","amount","currency","paypal_payment_currency","intent","onAuthorize","actions","tokenizePayment","payload","nonce","onCancel","onError","err","console","error","catch","zip","additionalData","hostedFieldsInstance","tokenize","tokenizeErr","code","details","invalidFields","key","field","braintree_tokenization_key","hostedFields","styles","input","font-size","font-family","body_font_family","font-weight",":focus","::placeholder",".valid",".invalid","fields","number","selector","cvv","expirationDate","OsPaymentsPaypal","Buttons","createOrder","order","purchase_units","currency_code","application_context","shipping_preference","onApprove","authorize","authorizationID","payments","authorizations","id","orderID","latepoint_register_stripe_card_elements","elements","element","event","latepoint_stripe_create_token","address_zip","latepoint_stripe","createToken","latepoint_stripe_elements_card_number","result","latepoint_init_stripe_form","Stripe","stripe_key","latepoint_stripe_elements","elementStyles","base","fontFamily","fontSize","fontWeight","elementClasses","focus","empty","invalid","classes","mount","latepoint_stripe_elements_card_expiry","latepoint_stripe_elements_card_cvc","latepoint_init_step","latepoint_init_step_selectable_items","latepoint_init_step_items_with_price","latepoint_init_step_datepicker","latepoint_init_step_contact","latepoint_init_step_agents","latepoint_init_step_services","latepoint_init_step_payment","latepoint_init_step_verify","latepoint_init_step_confirmation","show_next_btn","hide_next_btn","show_prev_btn","hide_prev_btn","day_timeslots","$day","service_duration","interval","work_start_minutes","work_end_minutes","total_work_minutes","available_minutes","toString","map","Number","day_minutes","$timeslots","prev_minutes","current_minutes","off_label","off_width","timeslot_class","includes","tick_html","timeslot_label","end_minutes","end_minutes_ampm","msg_not_available","os_init_timeslots","selected_timeslot_time","os_init_monthly_calendar_navigation","next_month_route_name","next","latepoint_calendar_set_month_label","$btn","$calendar_element","last","calendar_year","calendar_month","booking_info","target_date_string","location_id","agent_id","service_id","latepoint_calendar_show_or_hide_prev_next_buttons","prev","$scrollable_wrapper","stop","scrollHeight","latepoint_init_paypal_button","$booking_form_element","is_braintree_paypal_active","create_paypal_button","is_paypal_native_active","latepoint_init_cc_form","is_braintree_active","init_cc_form","is_stripe_active","latepoint_format_price","which","current_payment_step_class","portion","off","latepoint_selectable_item_clicked","latepoint_priced_item_clicked","operator","latepoint_change_booking_price","price","summary_value","toggleClass","ids","get","currency_symbol_before","currency_symbol_after","$category_wrapper","$main_parent","parent","duration_text","latepoint_init_step_locations","account_nonse","password","password_confirmation","param","latepoint_init_customer_dashboard_login","$login_form_wrapper","FB","login","authResponse","accessToken","latepoint_step_content_change_start","latepoint_step_content_change_end","scope","googleUser","$login_form_wrappers","gapi","load","auth2","init","client_id","attr","cookiepolicy","attachClickHandler","getAuthResponse","id_token","latepoint_init_facebook_login","latepoint_init_google_login","customer_name","latepoint_validate_fields","email","new_content","replaceWith","setTimeout","$booking_form_wrappers","latepoint_change_step_desc","$step_progress","prevAll","nextAll","side_panel_desc","top_header_desc","latepoint_progress_prev","latepoint_progress_next","latepoint_next_step_description","latepoint_prev_step_description","$fields","is_valid","index","latepoint_init_booking_form","$select_box","timezone_name","is_timezone_selected","tzid","Intl","DateTimeFormat","resolvedOptions","timeZone","change","className","match","join","is_pre_last_step","is_last_step","css","demo_mode","create_token","current_step","$services_step","parents","cancel_booking_prompt","$booking_box","route","target","$tabs_wrapper","booking_button_route","restrictions","show_service_categories","show_locations","show_services","show_agents","selected_location","selected_agent","selected_service","selected_service_category","calendar_start_date","isEmptyObject","lightbox_class","step"],"mappings":"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","sourcesContent":["function latepoint_is_timeframe_in_periods(timeframe_start, timeframe_end, periods_arr) {\n  var is_inside = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n  for (var i = 0; i < periods_arr.length; i++) {\n\n    var period_start = 0;\n    var period_end = 0;\n    var buffer_before = 0;\n    var buffer_after = 0;\n\n    var period_info = periods_arr[i].split(':');\n    if (period_info.length == 2) {\n      period_start = period_info[0];\n      period_end = period_info[1];\n    } else {\n      buffer_before = period_info[2];\n      buffer_after = period_info[3];\n      period_start = parseFloat(period_info[0]) - parseFloat(buffer_before);\n      period_end = parseFloat(period_info[1]) + parseFloat(buffer_after);\n    }\n    if (is_inside) {\n      if (latepoint_is_period_inside_another(timeframe_start, timeframe_end, period_start, period_end)) {\n        return true;\n      }\n    } else {\n      if (latepoint_is_period_overlapping(timeframe_start, timeframe_end, period_start, period_end)) {\n        return true;\n      }\n    }\n  };\n  return false;\n}\n\nfunction latepoint_is_period_overlapping(period_one_start, period_one_end, period_two_start, period_two_end) {\n  // https://stackoverflow.com/questions/325933/determine-whether-two-date-ranges-overlap/\n  return period_one_start < period_two_end && period_two_start < period_one_end;\n}\nfunction latepoint_is_period_inside_another(period_one_start, period_one_end, period_two_start, period_two_end) {\n  return period_one_start >= period_two_start && period_one_end <= period_two_end;\n}\n\n\n// Converts time in minutes to hours if possible, if minutes also exists - shows minutes too\nfunction latepoint_minutes_to_hours_preferably(time) {\n  var army_clock = latepoint_is_army_clock();\n\n  var hours = Math.floor(time / 60);\n  if (!army_clock && hours > 12) hours = hours - 12;\n\n  var minutes = time % 60;\n  if(minutes > 0) hours = hours + ':' + minutes;\n  return hours;\n}\n\n\nfunction latepoint_minutes_to_hours(time) {\n  var army_clock = latepoint_is_army_clock();\n\n  var hours = Math.floor(time / 60);\n  if (!army_clock && hours > 12) hours = hours - 12;\n  return hours;\n}\n\n\nfunction latepoint_am_or_pm(minutes) {\n  if(latepoint_is_army_clock()) return '';\n  return (minutes < 720) ? 'am' : 'pm';\n}\n\nfunction latepoint_hours_and_minutes_to_minutes(hours_and_minutes, ampm) {\n  var hours_and_minutes_arr = hours_and_minutes.split(':');\n  var hours = hours_and_minutes_arr[0];\n  var minutes = hours_and_minutes_arr[1];\n  if(ampm == \"pm\" && hours<12) hours = parseInt(hours)+12;\n  if(ampm == \"am\" && hours==12) hours = 0;\n  minutes = parseInt(minutes) + (hours * 60);\n  return minutes;\n}\n\nfunction latepoint_get_time_system(){\n  return latepoint_helper.time_system;\n}\n\nfunction latepoint_is_army_clock(){\n  return (latepoint_get_time_system() == '24');\n}\n\nfunction latepoint_minutes_to_hours_and_minutes(time) {\n  var army_clock = latepoint_is_army_clock();\n  var format = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '%02d:%02d';\n\n  var hours = Math.floor(time / 60);\n  if(!army_clock && (hours > 12)) hours = hours - 12;\n  var minutes = time % 60;\n  return sprintf(format, hours, minutes);\n}\n","function latepoint_mask_timefield($elem){\n\tif(jQuery().inputmask){\n\t  $elem.inputmask({\n\t      'mask': '99:99',\n\t      'placeholder': 'HH:MM'\n\t  });\n\t}\n}\n\nfunction latepoint_mask_phone($elem){\n\tif(latepoint_is_phone_masking_enabled() && jQuery().inputmask) $elem.inputmask(latepoint_get_phone_format());\n}\n\n\nfunction latepoint_get_phone_format(){\n  return latepoint_helper.phone_format;\n}\n\nfunction latepoint_is_phone_masking_enabled(){\n\treturn (latepoint_helper.enable_phone_masking == 'yes');\n}\n\nfunction latepoint_show_booking_end_time(){\n\treturn (latepoint_helper.show_booking_end_time == 'yes');\n}\n\nfunction latepoint_init_form_masks(){\n\tif(latepoint_is_phone_masking_enabled()) latepoint_mask_phone(jQuery('.os-mask-phone'));\n}\n\nfunction latepoint_get_paypal_payment_amount($booking_form_wrapper){\n\tvar payment_portion = $booking_form_wrapper.find('input[name=\"booking[payment_portion]\"]').val();\n\tvar payment_amount = (payment_portion == 'deposit') ? $booking_form_wrapper.find('.lp-paypal-btn-trigger').data('deposit-amount') : $booking_form_wrapper.find('.lp-paypal-btn-trigger').data('full-amount');\n\treturn payment_amount;\n}","function latepoint_add_notification(message, message_type = 'success'){\n\tvar wrapper = jQuery('body').find('.os-notifications');\n\tif(!wrapper.length){\n\t\tjQuery('body').append('<div class=\"os-notifications\"></div>');\n\t\twrapper = jQuery('body').find('.os-notifications');\n\t}\n\tif(wrapper.find('.item').length > 0) wrapper.find('.item:first-child').remove();\n\twrapper.append('<div class=\"item item-type-'+ message_type +'\">' + message + '<span class=\"os-notification-close\"><i class=\"latepoint-icon latepoint-icon-x\"></i></span></div>');\n}","function latepoint_generate_form_message_html(messages, status){\n  var message_html = '<div class=\"os-form-message-w status-' + status + '\"><ul>';\n  if(Array.isArray(messages)){\n    messages.forEach(function(message){\n      message_html+= '<li>' + message + '</li>';\n    });\n  }else{\n    message_html+= '<li>' + messages + '</li>';\n  }\n  message_html+= '</ul></div>';\n  return message_html;\n}\n\nfunction latepoint_clear_form_messages($form){\n  $form.find('.os-form-message-w').remove();\n}\n\nfunction latepoint_show_data_in_lightbox(message, extra_classes = ''){\n  jQuery('.latepoint-lightbox-w').remove();\n  var lightbox_css_classes = 'latepoint-lightbox-w latepoint-w ';\n  if(extra_classes) lightbox_css_classes+= extra_classes;\n  jQuery('body').append('<div class=\"'+ lightbox_css_classes +'\"><div class=\"latepoint-lightbox-i\">' + message + '<a href=\"#\" class=\"latepoint-lightbox-close\"><i class=\"latepoint-icon latepoint-icon-x\"></i></a></div><div class=\"latepoint-lightbox-shadow\"></div></div>');\n  jQuery('body').addClass('latepoint-lightbox-active');\n}\n\n\n\n// DOCUMENT READY\njQuery(document).ready(function( $ ) {\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  /* \n    Ajax buttons action\n  */\n  $('.latepoint').on('click', 'button[data-os-action], a[data-os-action], div[data-os-action], span[data-os-action]', function(e){\n    var $this = $(this);\n    if($this.data('os-prompt') && !confirm($this.data('os-prompt'))) return false;\n    var params = $(this).data('os-params');\n    if($(this).data('os-source-of-params')){\n      params = $($(this).data('os-source-of-params')).find('select, input, textarea').serialize();\n    }\n    var return_format = $this.data('os-return-format') ? $this.data('os-return-format') : 'json'\n    var data = { action: 'latepoint_route_call', route_name: $(this).data('os-action'), params: params, return_format: return_format } \n    $this.addClass('os-loading');\n    $.ajax({\n      type : \"post\",\n      dataType : \"json\",\n      url : latepoint_helper.ajaxurl,\n      data : data,\n      success: function(response){\n        if(response.status === \"success\"){\n          if($this.data('os-output-target') == 'lightbox'){\n            latepoint_show_data_in_lightbox(response.message, $this.data('os-lightbox-classes'));\n          }else if($this.data('os-output-target') == 'side-panel'){\n            $('.latepoint-side-panel-w').remove();\n            $('body').append('<div class=\"latepoint-side-panel-w\"><div class=\"latepoint-side-panel-i\">' + response.message + '</div><div class=\"latepoint-side-panel-shadow\"></div></div>');\n          }else if($this.data('os-success-action') == 'reload'){\n            latepoint_add_notification(response.message);\n            location.reload();\n            return;\n          }else if($this.data('os-success-action') == 'redirect'){\n            if($this.data('os-redirect-to')){\n              latepoint_add_notification(response.message);\n              window.location.replace($this.data('os-redirect-to'));\n            }else{\n              window.location.replace(response.message); \n            }\n            return;\n          }else if($this.data('os-output-target') && $($this.data('os-output-target')).length){\n            if($this.data('os-output-target-do') == 'append'){\n              $($this.data('os-output-target')).append(response.message);\n            }else{\n              $($this.data('os-output-target')).html(response.message);\n            }\n          }else{\n            if($this.data('os-before-after') == 'before'){\n              $this.before(response.message);\n            }else if($this.data('os-before-after') == 'before'){\n              $this.after(response.message);\n            }else{\n              latepoint_add_notification(response.message);\n            }\n          }\n          if($this.data('os-after-call')){\n            var func_name = $this.data('os-after-call');\n            if($this.data('os-pass-this')){\n              window[func_name]($this);\n            }else if($this.data('os-pass-response')){\n              window[func_name](response);\n            }else{\n              window[func_name]();\n            }\n          }\n          $this.removeClass('os-loading');\n        }else{\n          $this.removeClass('os-loading');\n          if($this.data('os-output-target') && $($this.data('os-output-target')).length){\n            $($this.data('os-output-target')).prepend(latepoint_generate_form_message_html(response.message, 'error'));\n          }else{\n            alert(response.message);\n          }\n        }\n      }\n    });\n    return false;\n  });\n\n\n  $('.latepoint').on('click', 'form[data-os-action] button[type=\"submit\"]', function(e){\n    $(this).addClass('os-loading');\n  });\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  /* \n    Form ajax submit action\n  */\n  $('.latepoint').on('submit', 'form[data-os-action]', function(e){\n    e.preventDefault(); // prevent native submit\n    var $form = $(this);\n    var form_data = $form.serialize();\n    var data = { action: 'latepoint_route_call', route_name: $(this).data('os-action'), params: form_data, return_format: 'json' }\n    $form.find('button[type=\"submit\"]').addClass('os-loading');\n    $.ajax({\n      type : \"post\",\n      dataType : \"json\",\n      url : latepoint_helper.ajaxurl,\n      data : data,\n      success: function(response){\n        $form.find('button[type=\"submit\"].os-loading').removeClass('os-loading');\n        latepoint_clear_form_messages($form);\n        if(response.status === \"success\"){\n          if($form.data('os-success-action') == 'reload'){\n            latepoint_add_notification(response.message);\n            location.reload();\n            return;\n          }else if($form.data('os-success-action') == 'redirect'){\n            if($form.data('os-redirect-to')){\n              latepoint_add_notification(response.message);\n              window.location.replace($form.data('os-redirect-to'));\n            }else{\n              window.location.replace(response.message);\n            }\n            return;\n          }else if($form.data('os-output-target') && $($form.data('os-output-target')).length){\n            $($form.data('os-output-target')).html(response.message);\n          }else{\n            if(response.message == 'redirect'){\n              window.location.replace(response.url);\n            }else{\n              latepoint_add_notification(response.message);\n              $form.prepend(latepoint_generate_form_message_html(response.message, 'success'));\n            }\n          }\n          if($form.data('os-record-id-holder') && response.record_id){\n            $form.find('[name=\"' + $form.data('os-record-id-holder') + '\"]').val(response.record_id)\n          }\n          if($form.data('os-after-call')){\n            var func_name = $form.data('os-after-call');\n            if($form.data('os-pass-response')){\n              window[func_name](response);\n            }else{\n              window[func_name]();\n            }\n          }\n          if(response.form_values_to_update){\n            $.each(response.form_values_to_update, function(name, value){\n              $form.find('[name=\"'+ name +'\"]').val(value);\n            });\n          }\n          $('button.os-loading').removeClass('os-loading');\n        }else{\n          $('button.os-loading').removeClass('os-loading');\n          if($form.data('os-show-errors-as-notification')){\n            latepoint_add_notification(response.message, 'error');\n          }else{\n            $form.prepend(latepoint_generate_form_message_html(response.message, 'error'));\n            $([document.documentElement, document.body]).animate({\n                scrollTop: ($form.find(\".os-form-message-w\").offset().top - 30)\n            }, 200);\n          }\n        }\n      }\n    });\n    return false;\n  });\n});","// @codekit-prepend \"os-time.js\"\n// @codekit-prepend \"os-shared.js\"\n// @codekit-prepend \"os-notifications.js\";\n// @codekit-prepend \"os-actions.js\"\n// @codekit-prepend \"os-payments-braintree.js\"\n// @codekit-prepend \"os-payments-paypal.js\"\n\n\nfunction latepoint_apply_coupon($elem){\n  var $booking_form_wrapper = $elem.closest('.latepoint-booking-form-element');\n\n  var $coupon_input = $elem;\n  $coupon_input.closest('.coupon-code-input-w').addClass('os-loading');\n  var form_params = $booking_form_wrapper.find('.latepoint-form').serialize();\n  var data = { action: 'latepoint_route_call', route_name: $elem.data('route'), params: form_params, layout: 'none', return_format: 'json' }\n  jQuery.ajax({\n    type : \"post\",\n    dataType : \"json\",\n    url : latepoint_helper.ajaxurl,\n    data : data,\n    success: function(data){\n      $coupon_input.closest('.coupon-code-input-w').removeClass('os-loading');\n      if(data.status === \"success\"){\n        latepoint_show_message_inside_element(data.message, $booking_form_wrapper.find('.latepoint-body'), 'success');\n        latepoint_reload_step($booking_form_wrapper);\n      }else{\n        latepoint_show_message_inside_element(data.message, $booking_form_wrapper.find('.latepoint-body'), 'error');\n      }\n    }\n  });\n}\n\nfunction latepoint_coupon_removed($elem){\n  $elem.closest('.applied-coupon-code').fadeOut();\n  var $booking_form_wrapper = $elem.closest('.latepoint-booking-form-element');\n  latepoint_reload_step($booking_form_wrapper);\n}\n\nfunction latepoint_reload_step($booking_form_wrapper){\n\n  $booking_form_wrapper.find('.latepoint_step_direction').val('specific');\n  $booking_form_wrapper.find('.latepoint-form').submit();\n\n  return false;\n}\n\n\nfunction latepoint_get_new_prev_payment_class($payment_step, new_current_payment_step_class){\n  var new_prev_payment_step_class = '';\n  switch(new_current_payment_step_class){\n    case 'lp-show-pay-times':\n      new_prev_payment_step_class = '';\n    break;\n    case 'lp-show-pay-methods':\n      if($payment_step.find('.lp-payment-times-w').length){\n        new_prev_payment_step_class = 'lp-show-pay-times';\n      }else{\n        new_prev_payment_step_class = latepoint_get_new_prev_payment_class($payment_step, 'lp-show-pay-times');\n      }\n    break;\n    case 'lp-show-pay-portion-selection':\n      if($payment_step.find('.lp-payment-methods-w').length){\n        new_prev_payment_step_class = 'lp-show-pay-methods';\n      }else{\n        new_prev_payment_step_class = latepoint_get_new_prev_payment_class($payment_step, 'lp-show-pay-methods');\n      }\n    break;\n    case 'lp-show-card':\n    case 'lp-show-paypal':\n      if($payment_step.find('.lp-payment-portion-selection-w').length){\n        new_prev_payment_step_class = 'lp-show-pay-portion-selection';\n      }else{\n        new_prev_payment_step_class = latepoint_get_new_prev_payment_class($payment_step, 'lp-show-pay-portion-selection');\n      }\n    break;\n  }\n  return new_prev_payment_step_class;\n}\n\n\nfunction latepoint_reset_password_from_booking_init(){\n  jQuery('.os-step-existing-customer-login-w').hide();\n  jQuery('.os-password-reset-form-holder').on('click', '.password-reset-back-to-login', function(){\n    jQuery('.os-password-reset-form-holder').html('');\n    jQuery('.os-step-existing-customer-login-w').show();\n    return false;\n  });\n}\n\nfunction latepoint_update_summary_field($form, field_name, value){\n  var $summary_holder = $form.closest('.latepoint-with-summary');\n  if(!$summary_holder.length) return;\n  value = String(value).trim();\n  if(value){\n    $form.find('.os-summary-value-'+field_name).text(value).closest('.os-summary-line').addClass('os-has-value');\n    if($summary_holder.hasClass('latepoint-summary-is-open')){\n      $form.find('.os-summary-line.os-has-value').slideDown(150);\n    }else{\n      $form.find('.os-summary-line.os-has-value').fadeIn(200);\n    }\n    $summary_holder.addClass('latepoint-summary-is-open');\n  }else{\n    $form.find('.os-summary-value-'+field_name).text('').closest('.os-summary-line').slideUp(150).removeClass('os-has-value');\n  }\n}\n\nfunction latepoint_password_changed_show_login(response){\n  jQuery('.os-step-existing-customer-login-w').show();\n  jQuery('.os-password-reset-form-holder').html('');\n  latepoint_show_message_inside_element(response.message, jQuery('.os-step-existing-customer-login-w'), 'success');\n}\n\nfunction latepoint_hide_message_inside_element($elem = jQuery('.latepoint-body')){\n  if($elem.length && $elem.find('.latepoint-message').length){\n    $elem.find('.latepoint-message').remove();\n  }\n}\n\nfunction latepoint_show_message_inside_element(message, $elem = jQuery('.latepoint-body'), message_type = 'error'){\n  if($elem.length){\n    if($elem.find('.latepoint-message').length){\n      $elem.find('.latepoint-message').removeClass('latepoint-message-success').removeClass('latepoint-message-error').addClass('latepoint-message-'+ message_type +'').html(message).show();\n    }else{\n      $elem.prepend('<div class=\"latepoint-message latepoint-message-'+ message_type +'\">' + message + '</div>');\n    }\n  }\n}\n\nfunction latepoint_clear_step_vars(step_name, $form){\n  switch(step_name) {\n    case 'locations':\n      $form.find('input[name=\"booking[start_date]\"]').val('');\n      break;\n    case 'services':\n      $form.find('input[name=\"booking[service_id]\"]').val('');\n      break;\n    case 'agents':\n      $form.find('input[name=\"booking[agent_id]\"]').val('');\n      break;\n    case 'datepicker':\n      $form.find('input[name=\"booking[start_date]\"]').val('');\n      $form.find('input[name=\"booking[start_time]\"]').val('');\n      break;\n  }\n}\n\nfunction latepoint_set_payment_token_and_submit($booking_form_wrapper, token){\n  $booking_form_wrapper.find('input[name=\"booking[payment_token]\"]').val(token);\n  var $booking_form = $booking_form_wrapper.find('.latepoint-form');\n  $booking_form.find('.latepoint_step_direction').val('next').submit();\n}\n\n( function( $ ) {\n  \"use strict\";\n\n  var latepoint_stripe;\n  var latepoint_stripe_elements;\n  var latepoint_stripe_elements_card_number;\n  var latepoint_stripe_elements_card_expiry;\n  var latepoint_stripe_elements_card_cvc;\n\n  function latepoint_register_stripe_card_elements(elements) {\n\n    // Listen for errors from each Element, and show error messages in the UI.\n    elements.forEach(function(element) {\n      element.on('change', function(event) {\n        if (event.error) {\n          latepoint_show_message_inside_element(event.error.message);\n        } else {\n          latepoint_hide_message_inside_element();\n        }\n      });\n    });\n\n  }\n\n\n  function latepoint_stripe_create_token($booking_form_wrapper){\n    // Gather additional customer data we may have collected in our form.\n    var name = jQuery($booking_form_wrapper).find('#payment_name_on_card');\n    var zip = jQuery($booking_form_wrapper).find('#payment_zip');\n    var additionalData = {\n      name: name ? name.value : undefined,\n      address_zip: zip ? zip.value : undefined,\n    };\n\n    // Use Stripe.js to create a token. We only need to pass in one Element\n    // from the Element group in order to create a token. We can also pass\n    // in the additional customer data we collected in our form.\n    latepoint_stripe.createToken(latepoint_stripe_elements_card_number, additionalData).then(function(result) {\n      // Stop loading!\n      // example.classList.remove('submitting');\n\n      if (result.token) {\n        // If we received a token, show the token ID.\n        latepoint_set_payment_token_and_submit($booking_form_wrapper, result.token.id);\n      } else {\n        latepoint_show_message_inside_element(result.error.message);\n        jQuery($booking_form_wrapper).find('.latepoint-next-btn').removeClass('os-loading');\n      }\n    });\n  }\n\n\n  function latepoint_init_stripe_form(){\n    latepoint_stripe = Stripe(latepoint_helper.stripe_key);\n\n    latepoint_stripe_elements = latepoint_stripe.elements();\n\n\n    var elementStyles = {\n      base: {\n        fontFamily: latepoint_helper.body_font_family,\n        fontSize: '14px',\n        fontWeight: 500,\n        color: '#ffffff',\n        '::placeholder': {\n          color: '#7d89b1',\n        },\n      }\n    };\n\n    var elementClasses = {\n      focus: 'focused',\n      empty: 'empty',\n      invalid: 'invalid',\n    };\n\n    latepoint_stripe_elements_card_number = latepoint_stripe_elements.create('cardNumber', {\n      style: elementStyles,\n      classes: elementClasses,\n      placeholder: jQuery('#payment_card_number').data('placeholder')\n    });\n    latepoint_stripe_elements_card_number.mount('#payment_card_number');\n\n    latepoint_stripe_elements_card_expiry = latepoint_stripe_elements.create('cardExpiry', {\n      style: elementStyles,\n      classes: elementClasses,\n      placeholder: jQuery('#payment_card_expiration').data('placeholder')\n    });\n    latepoint_stripe_elements_card_expiry.mount('#payment_card_expiration');\n\n    latepoint_stripe_elements_card_cvc = latepoint_stripe_elements.create('cardCvc', {\n      style: elementStyles,\n      classes: elementClasses,\n      placeholder: jQuery('#payment_card_cvc').data('placeholder')\n    });\n    latepoint_stripe_elements_card_cvc.mount('#payment_card_cvc');\n\n    latepoint_register_stripe_card_elements([latepoint_stripe_elements_card_number, latepoint_stripe_elements_card_expiry, latepoint_stripe_elements_card_cvc]);\n  }\n\n  function latepoint_init_step(step_name, $booking_form_wrapper = false){\n    latepoint_init_step_selectable_items();\n    latepoint_init_step_items_with_price();\n    switch(step_name){\n      case 'datepicker':\n        latepoint_init_step_datepicker();\n      break;\n      case 'contact':\n        latepoint_init_step_contact();\n      break;\n      case 'agents':\n        latepoint_init_step_agents();\n      break;\n      case 'locations':\n        latepoint_init_step_locations();\n      break;\n      case 'services':\n        latepoint_init_step_services()\n      break;\n      case 'payment':\n        latepoint_init_step_payment($booking_form_wrapper)\n      break;\n      case 'verify':\n        latepoint_init_step_verify($booking_form_wrapper)\n      break;\n      case 'confirmation':\n        latepoint_init_step_confirmation()\n      break;\n    }\n  }\n\n\n  function show_next_btn($booking_form_wrapper){\n    $booking_form_wrapper.find('.latepoint-next-btn').removeClass('disabled');\n    $booking_form_wrapper.removeClass('hidden-buttons');\n  }\n\n\n  function hide_next_btn($booking_form_wrapper){\n    $booking_form_wrapper.find('.latepoint-next-btn').addClass('disabled');\n    if($booking_form_wrapper.find('.latepoint-prev-btn.disabled').length) $booking_form_wrapper.addClass('hidden-buttons');\n  }\n\n\n  function show_prev_btn($booking_form_wrapper){\n    $booking_form_wrapper.find('.latepoint-prev-btn').removeClass('disabled');\n    $booking_form_wrapper.removeClass('hidden-buttons');\n  }\n\n  function hide_prev_btn($booking_form_wrapper){\n    $booking_form_wrapper.find('.latepoint-prev-btn').addClass('disabled');\n    if($booking_form_wrapper.find('.latepoint-next-btn.disabled').length) $booking_form_wrapper.addClass('hidden-buttons');\n  }\n\n\n  function day_timeslots($day){\n    var $booking_form_wrapper = $day.closest('.latepoint-booking-form-element');\n    $day.addClass('selected');\n\n    var service_duration = $day.data('service-duration');\n    var interval = $day.data('interval');\n    var work_start_minutes = $day.data('work-start-time');\n    var work_end_minutes = $day.data('work-end-time');\n    var total_work_minutes = $day.data('total-work-minutes');\n    var available_minutes = $day.data('available-minutes') ? $day.data('available-minutes').toString().split(',').map(Number) : false;\n    var day_minutes = $day.data('day-minutes').toString().split(',').map(Number);\n\n    var $timeslots = $booking_form_wrapper.find('.timeslots');\n    $timeslots.html('');\n\n    if(total_work_minutes > 0 && available_minutes.length && day_minutes.length){\n      var prev_minutes = false;\n      day_minutes.forEach(function(current_minutes){\n        if((current_minutes + service_duration) > work_end_minutes) return;\n        var ampm = latepoint_am_or_pm(current_minutes);\n        if(prev_minutes !== false && ((current_minutes - prev_minutes) > service_duration)){\n          // show interval that is off between two work periods\n          var off_label = latepoint_minutes_to_hours_and_minutes(prev_minutes + service_duration)+' '+ latepoint_am_or_pm(prev_minutes + service_duration) + ' - ' + latepoint_minutes_to_hours_and_minutes(current_minutes)+' '+latepoint_am_or_pm(current_minutes);\n          var off_width = (((current_minutes - prev_minutes - service_duration) / (total_work_minutes + service_duration)) * 100);\n          $timeslots.append('<div class=\"dp-timeslot is-off\" style=\"width:'+ off_width +'%\"><span class=\"dp-label\">' + off_label + '</span></div>');\n        }\n\n        var timeslot_class = 'dp-timeslot';\n        if(!available_minutes.includes(current_minutes)){\n          timeslot_class+= ' is-booked';\n        }\n        var tick_html = '';\n        if(((current_minutes % 60) == 0) || (interval >= 60)){\n          timeslot_class+= ' with-tick';\n          tick_html = '<span class=\"dp-tick\"><strong>'+latepoint_minutes_to_hours_preferably(current_minutes)+'</strong>'+' '+ampm+'</span>';\n        }\n        var timeslot_label = latepoint_minutes_to_hours_and_minutes(current_minutes)+' '+ampm;\n        if(latepoint_show_booking_end_time()){\n          var end_minutes = current_minutes + service_duration;\n          var end_minutes_ampm = latepoint_am_or_pm(end_minutes);\n          timeslot_label+= ' - ' + latepoint_minutes_to_hours_and_minutes(end_minutes)+' '+end_minutes_ampm;\n        }\n        timeslot_label = timeslot_label.trim();\n        $timeslots.append('<div class=\"'+timeslot_class+'\" data-minutes=\"' + current_minutes + '\"><span class=\"dp-label\">'+ timeslot_label +'</span>'+tick_html+'</div>');\n\n        prev_minutes = current_minutes;\n      });\n    }else{\n      // No working hours this day\n      $timeslots.append('<div class=\"not-working-message\">' + latepoint_helper.msg_not_available + \"</div>\");\n    }\n  }\n\n\n\n\n  function os_init_timeslots(){\n    $('.dp-timeslot').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      if($(this).hasClass('is-booked') || $(this).hasClass('is-off')){\n        // Show error message that you cant select a booked period\n      }else{\n        if($(this).hasClass('selected')){\n          $(this).removeClass('selected');\n          $(this).find('.dp-success-label').remove();\n          $booking_form_wrapper.find('.latepoint_start_time').val('');\n          hide_next_btn($booking_form_wrapper);\n          latepoint_update_summary_field($booking_form_wrapper, 'time', '');\n        }else{\n          $booking_form_wrapper.find('.dp-timeslot.selected').removeClass('selected').find('.dp-success-label').remove();\n          var selected_timeslot_time = $(this).find('.dp-label').html();\n          $(this).addClass('selected').find('.dp-label').html('<span class=\"dp-success-label\">' + $booking_form_wrapper.find('.latepoint-form').data('selected-label') + '</span>' + selected_timeslot_time);\n          $booking_form_wrapper.find('.latepoint_start_time').val($(this).data('minutes'));\n          show_next_btn($booking_form_wrapper);\n          latepoint_update_summary_field($booking_form_wrapper, 'time', selected_timeslot_time);\n        }\n      }\n      return false;\n    });\n  }\n\n  function os_init_monthly_calendar_navigation(){\n    $('.os-month-next-btn').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      var next_month_route_name = $(this).data('route');\n      if($booking_form_wrapper.find('.os-monthly-calendar-days-w.active + .os-monthly-calendar-days-w').length){\n        $booking_form_wrapper.find('.os-monthly-calendar-days-w.active').removeClass('active').next('.os-monthly-calendar-days-w').addClass('active');\n        latepoint_calendar_set_month_label($booking_form_wrapper);\n      }else{\n        // TODO add condition to check maximum number months to call into the future\n        if(true){\n          var $btn = $(this);\n          $btn.addClass('os-loading');\n          var $calendar_element = $booking_form_wrapper.find('.os-monthly-calendar-days-w').last();\n          var calendar_year = $calendar_element.data('calendar-year');\n          var calendar_month = $calendar_element.data('calendar-month');\n          if(calendar_month == 12){\n            calendar_year = calendar_year + 1;\n            calendar_month = 1;\n          }else{\n            calendar_month = calendar_month + 1;\n          }\n          var booking_info = { target_date_string: calendar_year + '-' + calendar_month + '-1', \n                                location_id: $booking_form_wrapper.find('.latepoint_location_id').val(), \n                                agent_id: $booking_form_wrapper.find('.latepoint_agent_id').val(), \n                                service_id: $booking_form_wrapper.find('.latepoint_service_id').val() };\n          var data = { action: 'latepoint_route_call', route_name: next_month_route_name, params: booking_info, layout: 'none', return_format: 'json' }\n          $.ajax({\n            type : \"post\",\n            dataType : \"json\",\n            url : latepoint_helper.ajaxurl,\n            data : data,\n            success: function(data){\n              $btn.removeClass('os-loading');\n              if(data.status === \"success\"){\n                $booking_form_wrapper.find('.os-months').append(data.message);\n                $booking_form_wrapper.find('.os-monthly-calendar-days-w.active').removeClass('active').next('.os-monthly-calendar-days-w').addClass('active');\n                latepoint_calendar_set_month_label($booking_form_wrapper);\n              }else{\n                // console.log(data.message);\n              }\n            }\n          });\n        }\n      }\n      latepoint_calendar_show_or_hide_prev_next_buttons($booking_form_wrapper);\n      return false;\n    });\n    $('.os-month-prev-btn').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      if($booking_form_wrapper.find('.os-monthly-calendar-days-w.active').prev('.os-monthly-calendar-days-w').length){\n        $booking_form_wrapper.find('.os-monthly-calendar-days-w.active').removeClass('active').prev('.os-monthly-calendar-days-w').addClass('active');\n        latepoint_calendar_set_month_label($booking_form_wrapper);\n      }\n      latepoint_calendar_show_or_hide_prev_next_buttons($booking_form_wrapper);\n      return false;\n    });\n  }\n\n  function latepoint_calendar_set_month_label($booking_form_wrapper){\n    $booking_form_wrapper.find('.os-current-month-label').text($booking_form_wrapper.find('.os-monthly-calendar-days-w.active').data('calendar-month-label'));\n  }\n\n\n  function latepoint_calendar_show_or_hide_prev_next_buttons($booking_form_wrapper){\n    $booking_form_wrapper.find('.os-current-month-label').html($booking_form_wrapper.find('.os-monthly-calendar-days-w.active .os-monthly-calendar-days').data('calendar-month-label'));\n    if($booking_form_wrapper.find('.os-monthly-calendar-days-w.active').prev('.os-monthly-calendar-days-w').length){\n      $booking_form_wrapper.find('.os-month-prev-btn').removeClass('disabled');\n    }else{\n      $booking_form_wrapper.find('.os-month-prev-btn').addClass('disabled');\n    }\n  }\n\n\n  function latepoint_init_step_datepicker(){\n    os_init_timeslots();\n    os_init_monthly_calendar_navigation();\n    $('.os-months').on('click', '.os-day', function(){\n      if($(this).hasClass('os-day-passed')) return false;\n      if($(this).hasClass('os-not-in-allowed-period')) return false;\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      $booking_form_wrapper.find('.os-day.selected').removeClass('selected');\n      day_timeslots($(this));\n      os_init_timeslots();\n      $('.times-header span').text($(this).data('nice-date'));\n      $booking_form_wrapper.find('.time-selector-w').slideDown(200, function(){\n        var $scrollable_wrapper = $booking_form_wrapper.find('.latepoint-body');\n        $scrollable_wrapper.stop().animate({\n          scrollTop: $scrollable_wrapper[0].scrollHeight\n        }, 200);\n      });\n      $booking_form_wrapper.find('.latepoint_start_date').val($(this).data('date'));\n      latepoint_update_summary_field($booking_form_wrapper, 'date', $(this).data('nice-date'));\n\n      $booking_form_wrapper.find('.latepoint_start_time').val('');\n      hide_next_btn($booking_form_wrapper);\n      return false;\n    });\n  }\n\n  function latepoint_init_paypal_button($booking_form_element){\n    $booking_form_element.find('.lp-paypal-btn-trigger').html('');\n    if(latepoint_helper.is_braintree_paypal_active){\n      OsPaymentsBraintree.create_paypal_button($booking_form_element.find('.lp-paypal-btn-trigger')[0]);\n    }\n    if(latepoint_helper.is_paypal_native_active){\n      OsPaymentsPaypal.create_paypal_button($booking_form_element.find('.lp-paypal-btn-trigger')[0]);\n    }\n    $('.lp-paypal-demo-mode-trigger').on('click', function(){\n      $(this).closest('.latepoint-form').submit();\n    });\n  }\n\n\n  function latepoint_init_cc_form($booking_form_element = false){\n    if($booking_form_element){\n      if(!$booking_form_element.find('.lp-card-w').length) return;\n    }else{\n      if(!$('.lp-card-w').length) return;\n    }\n    if(latepoint_helper.is_braintree_active){\n      OsPaymentsBraintree.init_cc_form();\n    }\n    if(latepoint_helper.is_stripe_active){\n      latepoint_init_stripe_form();\n    }\n  }\n\n  function latepoint_init_step_verify($booking_form_element = false){\n    if(!$booking_form_element) return;\n\n    $booking_form_element.closest('.latepoint-summary-is-open').removeClass('latepoint-summary-is-open');\n  }\n\n\n  function latepoint_init_step_payment($booking_form_element = false){\n    if($booking_form_element.find('.step-payment-w').data('full-amount') > 0){\n      latepoint_update_summary_field($booking_form_element, 'price', latepoint_format_price($booking_form_element.find('.step-payment-w').data('full-amount')));\n    }\n    if($booking_form_element && ($booking_form_element.find('.step-payment-w').data('default-portion') == 'deposit')){\n      $booking_form_element.find('input[name=\"booking[payment_portion]\"]').val('deposit');\n    }\n    latepoint_init_cc_form($booking_form_element);\n\n    if($booking_form_element && ($booking_form_element.find('.step-payment-w').data('current-payment-step') == 'lp-show-paypal')){\n      latepoint_init_paypal_button($booking_form_element);\n      hide_next_btn($booking_form_element);\n    }\n\n    $('.latepoint-booking-form-element .coupon-code-input-submit').on('click', function(e){\n      latepoint_apply_coupon($(this).closest('.coupon-code-input-w').find('.coupon-code-input'));\n      return false;\n    });\n\n    $('.latepoint-booking-form-element input.coupon-code-input').on('keyup', function(e){\n      if(e.which === 13){\n        latepoint_apply_coupon($(this));\n        return false;\n      }\n    });\n\n\n    $('.latepoint-booking-form-element .coupon-code-trigger-w a').on('click', function(e){\n      $(this).closest('.payment-total-info').addClass('entering-coupon').find('.coupon-code-input').focus();\n      return false;\n    });\n\n\n    $('.latepoint-booking-form-element .lp-payment-trigger-locally').on('click', function(e){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      $booking_form_element.find('input[name=\"booking[payment_method]\"]').val($(this).data('method'));\n      $booking_form_element.find('input[name=\"booking[payment_portion]\"]').val('');\n      show_next_btn($booking_form_element);\n    });\n\n    $('.latepoint-booking-form-element .lp-payment-trigger-method-selector').on('click', function(e){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      var $payment_step = $booking_form_element.find('.step-payment-w');\n      var current_payment_step_class = $payment_step.data('current-payment-step');\n      var new_current_payment_step_class = 'lp-show-pay-methods';\n\n      $payment_step.removeClass(current_payment_step_class)\n                  .addClass(new_current_payment_step_class)\n                  .data('current-payment-step', new_current_payment_step_class)\n                  .data('prev-payment-step', current_payment_step_class);\n      hide_next_btn($booking_form_element);\n      show_prev_btn($booking_form_element);\n      return false;\n    });\n\n    $('.latepoint-booking-form-element .lp-payment-trigger-cc').on('click', function(e){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      $booking_form_element.find('input[name=\"booking[payment_method]\"]').val($(this).data('method'));\n\n      var $payment_step = $booking_form_element.find('.step-payment-w');\n      var current_payment_step_class = $payment_step.data('current-payment-step');\n      var new_current_payment_step_class = 'lp-show-pay-portion-selection';\n\n      if(!$booking_form_element.find('.lp-payment-portion-selection-w').length){\n        // no deposits allowed\n        new_current_payment_step_class = 'lp-show-card';\n        show_next_btn($booking_form_element);\n      }else{\n        hide_next_btn($booking_form_element);\n      }\n      show_prev_btn($booking_form_element);\n      $payment_step.removeClass(current_payment_step_class)\n                  .addClass(new_current_payment_step_class)\n                  .data('current-payment-step', new_current_payment_step_class)\n                  .data('prev-payment-step', current_payment_step_class);\n    });\n\n    $('.latepoint-booking-form-element .lp-payment-trigger-paypal').on('click', function(e){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      $booking_form_element.find('input[name=\"booking[payment_method]\"]').val($(this).data('method'));\n\n      var $payment_step = $booking_form_element.find('.step-payment-w');\n      var current_payment_step_class = $payment_step.data('current-payment-step');\n      var new_current_payment_step_class = 'lp-show-pay-portion-selection';\n\n      if(!$booking_form_element.find('.lp-payment-portion-selection-w').length){\n        // no deposits allowed\n        latepoint_init_paypal_button($booking_form_element);\n        new_current_payment_step_class = 'lp-show-paypal';\n      }\n\n      $payment_step.removeClass(current_payment_step_class)\n                  .addClass(new_current_payment_step_class)\n                  .data('current-payment-step', new_current_payment_step_class)\n                  .data('prev-payment-step', current_payment_step_class);\n\n      hide_next_btn($booking_form_element);\n      show_prev_btn($booking_form_element);\n    });\n\n    $('.latepoint-booking-form-element .lp-trigger-payment-portion-selector').on('click', function(e){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      var portion = jQuery(this).data('portion');\n      $booking_form_element.find('input[name=\"booking[payment_portion]\"]').val(portion);\n      if(portion == 'deposit'){\n        $booking_form_element.find('.payment-total-info').addClass('paying-deposit');\n      }else{\n        $booking_form_element.find('.payment-total-info').removeClass('paying-deposit');\n      }\n\n      var $payment_step = $booking_form_element.find('.step-payment-w');\n      var current_payment_step_class = $payment_step.data('current-payment-step');\n      var new_current_payment_step_class = 'lp-show-card';\n      \n      if($booking_form_element.find('input[name=\"booking[payment_method]\"]').val() == 'card'){\n        // card\n        show_next_btn($booking_form_element);\n      }else{\n        // paypal\n        latepoint_init_paypal_button($booking_form_element);\n        new_current_payment_step_class = 'lp-show-paypal';\n        hide_next_btn($booking_form_element);\n      }\n      show_prev_btn($booking_form_element);\n\n      $payment_step.removeClass(current_payment_step_class)\n                  .addClass(new_current_payment_step_class)\n                  .data('current-payment-step', new_current_payment_step_class)\n                  .data('prev-payment-step', current_payment_step_class);\n    });\n\n\n  }\n\n\n  function latepoint_init_step_selectable_items(){\n    $('.os-selectable-items .os-selectable-item').off('click', latepoint_selectable_item_clicked);\n    $('.os-selectable-items .os-selectable-item').on('click', latepoint_selectable_item_clicked);\n  }\n\n  function latepoint_init_step_items_with_price(){\n    $('.os-selectable-items .os-priced-item').off('click', latepoint_priced_item_clicked);\n    $('.os-selectable-items .os-priced-item').on('click', latepoint_priced_item_clicked);\n  }\n\n  function latepoint_priced_item_clicked(){\n    var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n    var operator = ($(this).hasClass('selected')) ? '+' : '-';\n    latepoint_change_booking_price($(this).data('item-price'), $booking_form_wrapper, operator);\n    return false;\n  }\n\n  function latepoint_change_booking_price(amount, $booking_form_wrapper, operator){\n    var price = Number($booking_form_wrapper.find('.latepoint_total_price').val()) * 100;\n    amount = Number(amount) * 100;\n    price = (operator == '+') ? price + amount : price - amount;\n    price = price / 100;\n    $booking_form_wrapper.find('.latepoint_total_price').val(price);\n    if(price > 0){\n      price = latepoint_format_price(price);\n      latepoint_update_summary_field($booking_form_wrapper, 'price', price);\n    }else{\n      latepoint_update_summary_field($booking_form_wrapper, 'price', '');\n    }\n  }\n\n  function latepoint_selectable_item_clicked(){\n    var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n    var summary_value = '';\n    if($(this).hasClass('os-allow-multiselect')){\n      $(this).toggleClass('selected');\n      var ids = $(this).closest('.os-selectable-items').find('.os-selectable-item.selected').map(function(){ return $(this).data('item-id'); }).get();\n      $booking_form_wrapper.find($(this).data('id-holder')).val(ids);\n      summary_value = String($(this).closest('.os-selectable-items').find('.os-selectable-item.selected').map(function(){ return (' ' + $(this).data('summary-value')); }).get()).trim();\n    }else{\n      $(this).closest('.os-selectable-items').find('.os-selectable-item.selected').removeClass('selected');\n      $(this).addClass('selected');\n      $booking_form_wrapper.find($(this).data('id-holder')).val($(this).data('item-id'));\n      summary_value = $(this).data('summary-value');\n    }\n    latepoint_update_summary_field($booking_form_wrapper, $(this).data('summary-field-name'), summary_value);\n    show_next_btn($booking_form_wrapper);\n    return false;\n  }\n\n\n  function latepoint_format_price(price){\n    return latepoint_helper.currency_symbol_before + String(price) + latepoint_helper.currency_symbol_after;\n  }\n\n\n  function latepoint_init_step_services(){\n    $('.os-service-category-info').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      show_prev_btn($booking_form_wrapper);\n      $(this).closest('.step-services-w').addClass('selecting-service-category');\n      var $category_wrapper = $(this).closest('.os-service-category-w');\n      var $main_parent = $(this).closest('.os-service-categories-main-parent');\n      if($category_wrapper.hasClass('selected')){\n        $category_wrapper.removeClass('selected');\n        if($category_wrapper.parent().closest('.os-service-category-w').length){\n          $category_wrapper.parent().closest('.os-service-category-w').addClass('selected');\n        }else{\n          $main_parent.removeClass('show-selected-only');\n        }\n      }else{\n        $main_parent.find('.os-service-category-w.selected').removeClass('selected');\n        $main_parent.addClass('show-selected-only');\n        $category_wrapper.addClass('selected');\n      }\n      return false;\n    });\n    $('.os-services .os-service-duration-selector').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      $(this).closest('.os-items').find('.os-item.selected').removeClass('selected');\n      $(this).closest('.os-item').addClass('selected');\n      $booking_form_wrapper.find('.latepoint_duration').val($(this).data('duration'));\n      show_next_btn($booking_form_wrapper);\n      var duration_text = $(this).find('.os-duration-value').text() + ' ' + $(this).find('.os-duration-label').text();\n      latepoint_update_summary_field($booking_form_wrapper, 'duration', duration_text);\n      return false;\n    });\n\n    $('.os-services .os-service-selector').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      $(this).closest('.os-items').find('.os-item.selected').removeClass('selected');\n      $(this).closest('.os-item').addClass('selected');\n      $booking_form_wrapper.find('.latepoint_service_id').val($(this).data('service-id'));\n      $booking_form_wrapper.find('.latepoint_duration').val('');\n      if($(this).closest('.os-item').hasClass('has-multiple-durations')){\n        $(this).closest('.step-services-w').addClass('selecting-service-duration');\n        show_prev_btn($booking_form_wrapper);\n        hide_next_btn($booking_form_wrapper);\n      }else{\n        show_next_btn($booking_form_wrapper);\n      }\n      latepoint_update_summary_field($booking_form_wrapper, 'service', $(this).find('.os-item-name').text());\n      latepoint_update_summary_field($booking_form_wrapper, 'duration', '');\n      return false;\n    });\n  }\n\n  function latepoint_init_step_locations(){\n  }\n\n  function latepoint_init_step_agents(){\n    $('.os-items .os-item-details-btn').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      var agent_id = $(this).data('agent-id');\n      $booking_form_wrapper.find('.os-agent-bio-popup.active').removeClass('active');\n      $booking_form_wrapper.find('#osAgentBioPopup' + agent_id).addClass('active');\n      return false;\n    });\n    $('.os-agent-bio-close').on('click', function(){\n      $(this).closest('.os-agent-bio-popup').removeClass('active');\n      return false;\n    });\n  }\n\n\n  function latepoint_init_step_confirmation(){\n\n    $('.latepoint-booking-form-element').on('click', '.set-customer-password-btn', function(){\n      var $btn = $(this);\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n\n      $btn.addClass('os-loading');\n      var params = { account_nonse: $('input[name=\"account_nonse\"]').val(), password: $('input[name=\"customer[password]\"]').val(), password_confirmation: $('input[name=\"customer[password_confirmation]\"]').val()}\n      var data = { action: 'latepoint_route_call', route_name: $(this).data('btn-action'), params: $.param(params), layout: 'none', return_format: 'json' }\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          $btn.removeClass('os-loading');\n          if(data.status === \"success\"){\n            $booking_form_wrapper.find('.step-confirmation-set-password').html(latepoint_generate_form_message_html(data.message, 'success'));\n          }else{\n            latepoint_show_message_inside_element(data.message, $booking_form_wrapper.find('.step-confirmation-set-password'), 'error');\n          }\n        }\n      });\n    });\n\n    $('.latepoint-booking-form-element').on('click', '.show-set-password-fields', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n\n      $booking_form_wrapper.find('.step-confirmation-set-password').show();\n      $(this).closest('.info-box').hide();\n      return false;\n    });\n  }\n\n\n  function latepoint_init_customer_dashboard_login(){\n    if($('.latepoint-login-form-w #facebook-signin-btn').length && $('.latepoint-login-form-w').length){\n      $('.latepoint-login-form-w #facebook-signin-btn').on('click', function(){\n        var $login_form_wrapper = $(this).closest('.latepoint-login-form-w');\n        FB.login(function(response){\n          if (response.status === 'connected' && response.authResponse) {\n            var params = { token: response.authResponse.accessToken};\n            var data = { action: 'latepoint_route_call', route_name: $login_form_wrapper.find('#facebook-signin-btn').data('login-action'), params: $.param(params), layout: 'none', return_format: 'json' };\n            latepoint_step_content_change_start($login_form_wrapper);\n            $.ajax({\n              type : \"post\",\n              dataType : \"json\",\n              url : latepoint_helper.ajaxurl,\n              data : data,\n              success: function(data){\n                if(data.status === \"success\"){\n                  location.reload();\n                }else{\n                  latepoint_show_message_inside_element(data.message, $login_form_wrapper);\n                  latepoint_step_content_change_end(false, $login_form_wrapper);\n                }\n              }\n            });\n          } else {\n            \n          }\n        }, {scope: 'public_profile,email'});\n      });\n    }\n\n    if($('.latepoint-login-form-w #google-signin-btn').length && $('.latepoint-login-form-w').length){\n      // INIT GOOGLE LOGIN\n      var googleUser = {};\n\n      var $login_form_wrappers = $('.latepoint-login-form-w');\n      $login_form_wrappers.each(function(){\n        var $login_form_wrapper = $(this);\n        gapi.load('auth2', function(){\n          // Retrieve the singleton for the GoogleAuth library and set up the client.\n          var auth2 = gapi.auth2.init({\n            client_id: $login_form_wrapper.find('meta[name=google-signin-client_id]').attr(\"content\"),\n            cookiepolicy: 'single_host_origin',\n            // Request scopes in addition to 'profile' and 'email'\n            //scope: 'additional_scope'\n          });\n\n          auth2.attachClickHandler($login_form_wrapper.find('#google-signin-btn')[0], {},\n            function(googleUser) {\n              var params = { token: googleUser.getAuthResponse().id_token};\n              var data = { action: 'latepoint_route_call', route_name: $login_form_wrapper.find('#google-signin-btn').data('login-action'), params: $.param(params), layout: 'none', return_format: 'json' };\n              latepoint_step_content_change_start($login_form_wrapper);\n              $.ajax({\n                type : \"post\",\n                dataType : \"json\",\n                url : latepoint_helper.ajaxurl,\n                data : data,\n                success: function(data){\n                  if(data.status === \"success\"){\n                    location.reload();\n                  }else{\n                    latepoint_show_message_inside_element(data.message, $login_form_wrapper);\n                    latepoint_step_content_change_end(false, $login_form_wrapper);\n                  }\n                }\n              });\n            }, function(error) {\n              // console.log(JSON.stringify(error, undefined, 2));\n            });\n        });\n      });\n    }\n  }\n\n\n  function latepoint_init_step_contact(){\n    latepoint_init_facebook_login();\n    latepoint_init_google_login();\n    latepoint_init_form_masks();\n\n    $('.step-contact-w').each(function(){\n      var customer_name = $(this).find('input[name=\"customer[first_name]\"]').val() + ' ' + $(this).find('input[name=\"customer[last_name]\"]').val();\n      customer_name = customer_name.trim();\n      latepoint_update_summary_field($(this).closest('.latepoint-booking-form-element'), 'customer', customer_name);\n    });\n\n    $('.step-contact-w').on('keyup', 'input[name=\"customer[first_name]\"], input[name=\"customer[last_name]\"]', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      latepoint_update_summary_field($booking_form_wrapper, 'customer', $booking_form_wrapper.find('input[name=\"customer[first_name]\"]').val() + ' ' + $booking_form_wrapper.find('input[name=\"customer[last_name]\"]').val());\n    });\n\n    $('.step-contact-w').on('keyup', '.os-form-control.required', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      if(latepoint_validate_fields($booking_form_wrapper.find('.step-contact-w .os-form-control.required'))){\n      }else{\n      }\n    });\n\n    // Init Logout button\n    $('.step-customer-logout-btn').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      var data = { action: 'latepoint_route_call', route_name: $(this).data('btn-action'), layout: 'none', return_format: 'json' }\n      latepoint_step_content_change_start($booking_form_wrapper);\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          latepoint_reload_step($booking_form_wrapper);\n        }\n      });\n      return false;\n    });\n\n    // Init Login Existing Customer Button\n    $('.step-login-existing-customer-btn').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      var params = { email: $booking_form_wrapper.find('.os-step-existing-customer-login-w input[name=\"customer_login[email]\"]').val(), password: $booking_form_wrapper.find('.os-step-existing-customer-login-w input[name=\"customer_login[password]\"]').val()}\n      var data = { action: 'latepoint_route_call', route_name: $(this).data('btn-action'), params: $.param(params), layout: 'none', return_format: 'json' }\n      latepoint_step_content_change_start($booking_form_wrapper);\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n            if(data.status === \"success\"){\n              latepoint_reload_step($booking_form_wrapper);\n            }else{\n              latepoint_show_message_inside_element(data.message, $booking_form_wrapper.find('.os-step-existing-customer-login-w'));\n              latepoint_step_content_change_end(false, $booking_form_wrapper);\n            }\n        }\n      });\n      return false;\n    });\n  }\n\n  function latepoint_step_content_change_start($booking_form_wrapper){\n    $booking_form_wrapper.removeClass('step-content-loaded').addClass('step-content-loading');\n  }\n\n  // TODO\n  function latepoint_step_content_change_end(new_content, $booking_form_wrapper){\n    if(new_content) $booking_form_wrapper.find('.latepoint-body .latepoint-step-content').replaceWith(new_content);\n    $booking_form_wrapper.removeClass('step-content-loading').addClass('step-content-mid-loading');\n    setTimeout(function(){\n      $booking_form_wrapper.removeClass('step-content-mid-loading').addClass('step-content-loaded');\n    }, 50);\n  }\n\n  function latepoint_init_facebook_login(){\n    if(!$('#facebook-signin-btn').length || !$('.latepoint-booking-form-element').length) return;\n    $('#facebook-signin-btn').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      FB.login(function(response){\n        if (response.status === 'connected' && response.authResponse) {\n          var params = { token: response.authResponse.accessToken};\n          var data = { action: 'latepoint_route_call', route_name: $booking_form_wrapper.find('#facebook-signin-btn').data('login-action'), params: $.param(params), layout: 'none', return_format: 'json' };\n          latepoint_step_content_change_start($booking_form_wrapper);\n          $.ajax({\n            type : \"post\",\n            dataType : \"json\",\n            url : latepoint_helper.ajaxurl,\n            data : data,\n            success: function(data){\n              if(data.status === \"success\"){\n                latepoint_reload_step($booking_form_wrapper);\n              }else{\n                latepoint_show_message_inside_element(data.message, $booking_form_wrapper.find('.os-step-existing-customer-login-w '));\n                latepoint_step_content_change_end(false, $booking_form_wrapper);\n              }\n            }\n          });\n        } else {\n          \n        }\n      }, {scope: 'public_profile,email'});\n    });\n  }\n\n  function latepoint_init_google_login(){\n    if(!$('#google-signin-btn').length || !$('.latepoint-booking-form-element').length) return;\n    var googleUser = {};\n\n    var $booking_form_wrappers = $('.latepoint-booking-form-element');\n    $booking_form_wrappers.each(function(){\n      var $booking_form_wrapper = $(this);\n      gapi.load('auth2', function(){\n        // Retrieve the singleton for the GoogleAuth library and set up the client.\n        var auth2 = gapi.auth2.init({\n          client_id: $booking_form_wrapper.find('meta[name=google-signin-client_id]').attr(\"content\"),\n          cookiepolicy: 'single_host_origin',\n          // Request scopes in addition to 'profile' and 'email'\n          //scope: 'additional_scope'\n        });\n\n        auth2.attachClickHandler($booking_form_wrapper.find('#google-signin-btn')[0], {},\n          function(googleUser) {\n            var params = { token: googleUser.getAuthResponse().id_token};\n            var data = { action: 'latepoint_route_call', route_name: $booking_form_wrapper.find('#google-signin-btn').data('login-action'), params: $.param(params), layout: 'none', return_format: 'json' };\n            latepoint_step_content_change_start($booking_form_wrapper);\n            $.ajax({\n              type : \"post\",\n              dataType : \"json\",\n              url : latepoint_helper.ajaxurl,\n              data : data,\n              success: function(data){\n                if(data.status === \"success\"){\n                  latepoint_reload_step($booking_form_wrapper);\n                }else{\n                  latepoint_show_message_inside_element(data.message, $booking_form_wrapper.find('.os-step-existing-customer-login-w '));\n                  latepoint_step_content_change_end(false, $booking_form_wrapper);\n                }\n              }\n            });\n          }, function(error) {\n            // console.log(JSON.stringify(error, undefined, 2));\n          });\n      });\n    });\n  }\n\n  function latepoint_change_step_desc($booking_form_wrapper, step_name){\n    $booking_form_wrapper.removeClass('step-changed').addClass('step-changing');\n    setTimeout(function(){\n      // Progress bar\n      var $step_progress = $booking_form_wrapper.find('.latepoint-progress li[data-step-name=\"' + step_name + '\"]');\n      $step_progress.addClass('active').addClass('complete').prevAll().addClass('complete').removeClass('active');\n      $step_progress.nextAll().removeClass('complete').removeClass('active');\n      // Side panel\n      var side_panel_desc = $booking_form_wrapper.find('.latepoint-step-desc-library[data-step-name=\"' + step_name + '\"]').html();\n      $booking_form_wrapper.find('.latepoint-step-desc').html(side_panel_desc);\n\n      // Top header\n      var top_header_desc = $booking_form_wrapper.find('.os-heading-text-library[data-step-name=\"' + step_name + '\"]').html();\n      $booking_form_wrapper.find('.os-heading-text').html(top_header_desc);\n      setTimeout(function(){\n          $booking_form_wrapper.removeClass('step-changing').addClass('step-changed');\n      }, 50);\n    }, 500);\n  }\n\n\n  function latepoint_progress_prev($booking_form_wrapper, step_name){\n    var $step_progress = $booking_form_wrapper.find('.latepoint-progress li[data-step-name=\"' + step_name + '\"]');\n    $step_progress.addClass('active').addClass('complete').prevAll().addClass('complete').removeClass('active');\n    $step_progress.nextAll().removeClass('complete').removeClass('active');\n  }\n\n\n  function latepoint_progress_next($booking_form_wrapper, step_name){\n    var $step_progress = $booking_form_wrapper.find('.latepoint-progress li[data-step-name=\"' + step_name + '\"]');\n    $step_progress.addClass('active').addClass('complete').prevAll().addClass('complete').removeClass('active');\n    $step_progress.nextAll().removeClass('complete').removeClass('active');\n  }\n\n\n  function latepoint_next_step_description($booking_form_wrapper, step_name){\n    $booking_form_wrapper.removeClass('step-changed').addClass('step-changing');\n    setTimeout(function(){\n      $booking_form_wrapper.find('.latepoint-step-desc').html($booking_form_wrapper.find('.latepoint-step-desc-library.active').removeClass('active').next('.latepoint-step-desc-library').addClass('active').html());\n      $booking_form_wrapper.find('.os-heading-text').html($booking_form_wrapper.find('.os-heading-text-library.active').removeClass('active').next('.os-heading-text-library').addClass('active').html());\n      setTimeout(function(){\n        $booking_form_wrapper.removeClass('step-changing').addClass('step-changed');\n      }, 50);\n    }, 500);\n  }\n  function latepoint_prev_step_description($booking_form_wrapper, step_name){\n    $booking_form_wrapper.removeClass('step-changed').addClass('step-changing');\n    setTimeout(function(){\n      $booking_form_wrapper.find('.latepoint-step-desc').html($booking_form_wrapper.find('.latepoint-step-desc-library.active').removeClass('active').prev('.latepoint-step-desc-library').addClass('active').html());\n      $booking_form_wrapper.find('.os-heading-text').html($booking_form_wrapper.find('.os-heading-text-library.active').removeClass('active').prev('.os-heading-text-library').addClass('active').html());\n      setTimeout(function(){\n        $booking_form_wrapper.removeClass('step-changing').addClass('step-changed');\n      }, 50);\n    }, 500);\n  }\n\n\n  function latepoint_validate_fields($fields){\n    var is_valid = true;\n    $fields.each(function(index){\n      if($(this).val() == ''){\n        is_valid = false;\n        return false;\n      }\n    });\n    return is_valid;\n  }\n\n\n  function latepoint_init_booking_form(){\n    $('.latepoint-lightbox-close').on('click', function(){\n      $('body').removeClass('latepoint-lightbox-active');\n      $('.latepoint-lightbox-w').remove();\n      return false;\n    });\n\n\n    $('.latepoint-customer-timezone-selector-w select').on('change', function(e){\n      var $select_box = $(this);\n      $select_box.closest('.latepoint-customer-timezone-selector-w').addClass('os-loading');\n      var data = { action: 'latepoint_route_call', route_name: $(this).closest('.latepoint-customer-timezone-selector-w').data('route-name'), params: { timezone_name: $(this).val()}, layout: 'none', return_format: 'json'}\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          $select_box.closest('.latepoint-customer-timezone-selector-w').removeClass('os-loading');\n          if(data.status === \"success\"){\n            location.reload();\n          }else{\n\n          }\n        }\n      });\n    });\n\n    $('.latepoint-timezone-selector-w select').on('change', function(e){\n      var $select_box = $(this);\n      $select_box.closest('.latepoint-timezone-selector-w').addClass('os-loading');\n      var data = { action: 'latepoint_route_call', route_name: $(this).closest('.latepoint-timezone-selector-w').data('route-name'), params: { timezone_name: $(this).val()}, layout: 'none', return_format: 'json'}\n      var $booking_form_wrapper = $select_box.closest('.latepoint-booking-form-element');\n      $booking_form_wrapper.removeClass('step-content-loaded').addClass('step-content-loading');\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          $select_box.closest('.latepoint-timezone-selector-w').removeClass('os-loading');\n          $booking_form_wrapper.removeClass('step-content-loading');\n          if(data.status === \"success\"){\n            // reload datepicker if its the step\n            if($select_box.closest('.latepoint-booking-form-element').hasClass('current-step-datepicker')){\n              latepoint_reload_step($select_box.closest('.latepoint-booking-form-element'));\n            }\n          }else{\n\n          }\n        }\n      });\n    });\n\n    if(!latepoint_helper.is_timezone_selected){\n      const tzid = Intl.DateTimeFormat().resolvedOptions().timeZone;\n      if(tzid){\n        if(tzid != $('.latepoint-timezone-selector-w select').val()) $('.latepoint-timezone-selector-w select').val(tzid).change();\n      }\n    }\n\n    $('.latepoint-booking-form-element .latepoint-form').on('submit', function(e){\n      var $booking_form = $(this);\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      e.preventDefault();\n      var form_data = $booking_form.serialize();\n      var data = { action: 'latepoint_route_call', route_name: $booking_form.data('route-name'), params: form_data, layout: 'none', return_format: 'json'}\n      $booking_form_wrapper.removeClass('step-content-loaded').addClass('step-content-loading');\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          if(data.status === \"success\"){\n            $booking_form_wrapper.find('.latepoint_current_step').val(data.step_name);\n            $booking_form_wrapper.removeClass(function (index, className) { return (className.match (/(^|\\s)current-step-\\S+/g) || []).join(' '); }).addClass('current-step-' + data.step_name);\n            setTimeout(function(){\n              $booking_form_wrapper.removeClass('step-content-loading').addClass('step-content-mid-loading');\n              $booking_form_wrapper.find('.latepoint-body').html(data.message);\n              latepoint_init_step(data.step_name, $booking_form_wrapper);\n              setTimeout(function(){\n                $booking_form_wrapper.removeClass('step-content-mid-loading').addClass('step-content-loaded');\n                $booking_form_wrapper.find('.latepoint-next-btn, .latepoint-prev-btn').removeClass('os-loading');\n              }, 50);\n            }, 500);\n\n            if(data.is_pre_last_step){\n              $booking_form_wrapper.find('.latepoint-next-btn span').text($booking_form_wrapper.find('.latepoint-next-btn').data('pre-last-step-label'));\n            }else{\n              $booking_form_wrapper.find('.latepoint-next-btn span').text($booking_form_wrapper.find('.latepoint-next-btn').data('label'));\n            }\n            if(data.is_last_step){\n              $booking_form_wrapper.addClass('hidden-buttons').find('.latepoint-footer').remove();\n              $booking_form_wrapper.find('.latepoint-progress').css( 'opacity', 0 );\n              $booking_form_wrapper.closest('.latepoint-summary-is-open').removeClass('latepoint-summary-is-open');\n              $booking_form_wrapper.addClass('is-final-step');\n            }else{\n              if(data.show_next_btn === true){\n                show_next_btn($booking_form_wrapper);\n              }else{\n                hide_next_btn($booking_form_wrapper);\n              }\n              if(data.show_prev_btn === true){\n                show_prev_btn($booking_form_wrapper);\n              }else{\n                hide_prev_btn($booking_form_wrapper);\n              }\n            }\n            \n\n            latepoint_change_step_desc($booking_form_wrapper, data.step_name);\n          }else{\n            $booking_form_wrapper.removeClass('step-content-loading').addClass('step-content-loaded');\n            $booking_form_wrapper.find('.latepoint-next-btn, .latepoint-prev-btn').removeClass('os-loading');\n            latepoint_show_message_inside_element(data.message, $booking_form_wrapper.find('.latepoint-body'));\n          }\n          $booking_form.find('.latepoint_step_direction').val('next');\n        }\n      });\n    });\n\n    \n\n    $('.latepoint-booking-form-element').on('click', '.lp-option', function(){\n      $(this).closest('.lp-options').find('.lp-option.selected').removeClass('selected');\n      $(this).addClass('selected');\n    });\n\n\n\n\n    // Next Step button Click\n    $('.latepoint-booking-form-element .latepoint-next-btn').on('click', function(e){\n      if($(this).hasClass('disabled') || $(this).hasClass('os-loading')) return false;\n      var $booking_form = $(this).closest('.latepoint-form');\n      var $booking_form_wrapper = $booking_form.closest('.latepoint-booking-form-element');\n\n      $booking_form.find('.latepoint_step_direction').val('next');\n      if(($booking_form_wrapper.find('.latepoint_current_step').val() == 'payment') && ($booking_form_wrapper.find('input[name=\"booking[payment_method]\"]').val() == 'card') && !latepoint_helper.demo_mode){\n        if(latepoint_helper.is_stripe_active){\n          latepoint_stripe_create_token($booking_form_wrapper);\n        }\n        if(latepoint_helper.is_braintree_active){\n          OsPaymentsBraintree.create_token($booking_form_wrapper);\n        }\n      }else{\n        $booking_form.submit();\n      }\n      $(this).addClass('os-loading');\n      return false;\n    });\n\n\n    // Previous Step button Click\n    $('.latepoint-booking-form-element .latepoint-prev-btn').on('click', function(e){\n      if($(this).hasClass('disabled') || $(this).hasClass('os-loading')) return false;\n      var $booking_form = $(this).closest('.latepoint-form');\n      var $booking_form_wrapper = $booking_form.closest('.latepoint-booking-form-element');\n\n      var current_step = $booking_form.find('.latepoint_current_step').val();\n\n      if(current_step == 'payment'){\n        var $payment_step = $booking_form_wrapper.find('.step-payment-w');\n        if($payment_step.length){\n          $payment_step.find('.lp-option.selected').removeClass('selected');\n          var current_payment_step_class = $payment_step.data('current-payment-step');\n          var new_current_payment_step_class = $payment_step.data('prev-payment-step');\n          if(new_current_payment_step_class){\n            var new_prev_payment_step_class = latepoint_get_new_prev_payment_class($payment_step, new_current_payment_step_class);\n            $payment_step.removeClass(current_payment_step_class)\n                        .addClass(new_current_payment_step_class)\n                        .data('current-payment-step', new_current_payment_step_class)\n                        .data('prev-payment-step', new_prev_payment_step_class);\n            hide_next_btn($booking_form_wrapper);\n            return false;\n          }\n        }\n      }\n      if(current_step == 'services'){\n        var $services_step = $booking_form_wrapper.find('.step-services-w');\n        if($services_step.hasClass('selecting-service-duration')){\n          $services_step.removeClass('selecting-service-duration');\n          $services_step.find('.os-services > .os-item.selected').removeClass('selected');\n          return false;\n        }\n        if($services_step.hasClass('selecting-service-category')){\n          if($services_step.find('.os-service-category-w .os-service-category-w.selected').length){\n            $services_step.find('.os-service-category-w .os-service-category-w.selected').parents('.os-service-category-w').addClass('selected').find('.os-service-category-w.selected').removeClass('selected');\n          }else{\n            $services_step.removeClass('selecting-service-category').find('.os-service-category-w.selected').removeClass('selected');\n            $services_step.removeClass('selecting-service-category').find('.os-service-categories-holder.show-selected-only').removeClass('show-selected-only');\n          }\n          return false;\n        }\n      }\n\n      latepoint_clear_step_vars($booking_form.find('.latepoint_current_step').val(), $booking_form);\n      $booking_form.find('.latepoint_step_direction').val('prev');\n      $booking_form.submit();\n      $booking_form.closest('.latepoint-with-summary').addClass('latepoint-summary-is-open');\n      $(this).addClass('os-loading');\n      return false;\n    });\n  }\n\n  // DOCUMENT READY\n  $( function() {\n\n    latepoint_init_customer_dashboard_login();\n\n    if($('.latepoint-booking-form-element').length){\n      latepoint_init_booking_form();\n      $('.latepoint-booking-form-element').each(function(){\n        latepoint_init_step($(this).find('.latepoint_current_step').val());\n      });\n    }\n\n    $('.latepoint-request-booking-cancellation').on('click', function(){\n      if(!confirm(latepoint_helper.cancel_booking_prompt)) return false;\n      var $this = $(this);\n      var $booking_box = $this.closest('.customer-booking');\n\n      var route = $(this).data('route');\n      var params = {id: $booking_box.data('id')};\n\n      var data = { action: 'latepoint_route_call', route_name: route, params: params, layout: 'none', return_format: 'json' }\n      $this.addClass('os-loading');\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          if(data.status === \"success\"){\n            location.reload();\n          }else{\n            $this.removeClass('os-loading');\n          }\n        }\n      });\n      return false;\n    });\n\n\n    $('body').on('click', '.os-step-tabs .os-step-tab', function(){\n      $(this).closest('.os-step-tabs').find('.os-step-tab').removeClass('active');\n      $(this).addClass('active');\n      var target = $(this).data('target');\n      $(this).closest('.os-step-tabs-w').find('.os-step-tab-content').hide();\n      $(target).show();\n    });\n\n    $('body').on('keyup', '.os-form-group .os-form-control', function(){\n      if($(this).val()){\n        $(this).closest('.os-form-group').addClass('has-value');\n      }else{\n        $(this).closest('.os-form-group').removeClass('has-value');\n      }\n    });\n\n    $('.latepoint-tab-triggers').on('click', '.latepoint-tab-trigger', function(){\n      var $tabs_wrapper = $(this).closest('.latepoint-tabs-w')\n      $tabs_wrapper.find('.latepoint-tab-trigger.active').removeClass('active');\n      $tabs_wrapper.find('.latepoint-tab-content').removeClass('active');\n      $(this).addClass('active');\n      $tabs_wrapper.find('.latepoint-tab-content' + $(this).data('tab-target')).addClass('active');\n      return false;\n    });\n\n\n    // Main Button to trigger lightbox opening\n    $('.latepoint-book-button, .os_trigger_booking').on('click', function(){\n      var $this = $(this);\n      var route = latepoint_helper.booking_button_route;\n      var params = {};\n      var restrictions = {};\n      if($this.data('show-service-categories')) restrictions.show_service_categories = $this.data('show-service-categories');\n      if($this.data('show-locations')) restrictions.show_locations = $this.data('show-locations');\n      if($this.data('show-services')) restrictions.show_services = $this.data('show-services');\n      if($this.data('show-agents')) restrictions.show_agents = $this.data('show-agents');\n      if($this.data('selected-location')) restrictions.selected_location = $this.data('selected-location');\n      if($this.data('selected-agent')) restrictions.selected_agent = $this.data('selected-agent');\n      if($this.data('selected-service')) restrictions.selected_service = $this.data('selected-service');\n      if($this.data('selected-service-category')) restrictions.selected_service_category = $this.data('selected-service-category');\n      if($this.data('calendar-start-date')) restrictions.calendar_start_date = $this.data('calendar-start-date');\n\n      if($.isEmptyObject(restrictions) == false) params.restrictions = restrictions;\n\n      var data = { action: 'latepoint_route_call', route_name: route, params: params, layout: 'none', return_format: 'json' }\n      $this.addClass('os-loading');\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          if(data.status === \"success\"){\n            var lightbox_class = 'latepoint-lightbox-v2';\n            if($this.data('hide-summary') != 'yes') lightbox_class+= ' latepoint-with-summary';\n            latepoint_show_data_in_lightbox(data.message, lightbox_class);\n            latepoint_init_booking_form();\n            latepoint_init_step(data.step);\n            $('body').addClass('latepoint-lightbox-active');\n            $this.removeClass('os-loading');\n            \n          }else{\n            $this.removeClass('os-loading');\n            // console.log(data.message);\n          }\n        }\n      });\n\n      return false;\n    });\n\n\n\n  });\n\n\n} )( jQuery );\n","class OsPaymentsBraintree {\n\n\n  static create_paypal_button(button){\n  \tlet $booking_form_wrapper = jQuery(button).closest('.latepoint-booking-form-element');\n  \tvar payment_amount = latepoint_get_paypal_payment_amount($booking_form_wrapper);\n  \t\n    braintree.client.create({\n      authorization: latepoint_helper.braintree_paypal_client_auth\n    }).then(function (clientInstance) {\n      // Create a PayPal Checkout component.\n      return braintree.paypalCheckout.create({\n        client: clientInstance\n      });\n    }).then(function (paypalCheckoutInstance) {\n      // Set up PayPal with the checkout.js library\n      return paypal.Button.render({\n      \tstyle: {\n      \t\tlabel: 'pay',\n      \t\tsize: 'large',\n      \t\tshape:   'rect',\n      \t\ttagline: false,\n      \t\tcolor: 'gold'\n      \t},\n        env: latepoint_helper.braintree_paypal_environment_name, // or 'sandbox'\n\n        payment: function () {\n          return paypalCheckoutInstance.createPayment({\n            flow: 'checkout', // Required\n            amount: payment_amount, // Required\n            currency: latepoint_helper.paypal_payment_currency,\n            intent: 'authorize' // Required\n            // Your PayPal options here. For available options, see\n            // http://braintree.github.io/braintree-web/current/PayPalCheckout.html#createPayment\n          });\n        },\n\n\n        onAuthorize: function (data, actions) {\n          return paypalCheckoutInstance.tokenizePayment(data)\n            .then(function (payload) {\n\t\t\t        latepoint_set_payment_token_and_submit($booking_form_wrapper, payload.nonce);\n            });\n        },\n\n        onCancel: function (data) {\n          // console.log('checkout.js payment cancelled', JSON.stringify(data, 0, 2));\n        },\n\n        onError: function (err) {\n          console.error('checkout.js error', err);\n        }\n      }, button);\n    }).then(function () {\n      // The PayPal button will be rendered in an html element with the id\n      // `paypal-button`. This function will be called when the PayPal button\n      // is set up and ready to be used.\n    }).catch(function (err) {\n      console.error('Error!', err);\n      // Handle component creation error\n    });\n  }\n\n\tstatic create_token($booking_form_wrapper){\n\t  // Gather additional customer data we may have collected in our form.\n\t  var name = jQuery($booking_form_wrapper).find('#payment_name_on_card');\n\t  var zip = jQuery($booking_form_wrapper).find('#payment_zip');\n\t  var additionalData = {\n\t    name: name ? name.value : undefined,\n\t    address_zip: zip ? zip.value : undefined,\n\t  };\n\n\t  OsPaymentsBraintree.hostedFieldsInstance.tokenize(function (tokenizeErr, payload) {\n\t    if (tokenizeErr) {\n\t    \tif(tokenizeErr.code == 'HOSTED_FIELDS_FIELDS_INVALID' && tokenizeErr.details.invalidFields){\n\t    \t\tjQuery.each(tokenizeErr.details.invalidFields, function(key, field){\n\t    \t\t\tjQuery(field).addClass('braintree-hosted-fields-invalid');\n\t    \t\t});\n\t    \t}\n\t      latepoint_show_message_inside_element(tokenizeErr.message);\n\t      jQuery($booking_form_wrapper).find('.latepoint-next-btn').removeClass('os-loading');\n\t    }else{\n\t      // If we received a token, show the token ID.\n        latepoint_set_payment_token_and_submit($booking_form_wrapper, payload.nonce);\n\t    }\n\t  });\n\t}\n\n\n\n\n\tstatic init_cc_form(){\n\t\tbraintree.client.create({\n\t\t  authorization: latepoint_helper.braintree_tokenization_key\n\t\t}, function(err, clientInstance) {\n\t\t  if (err) {\n\t\t    console.error(err);\n\t\t    return;\n\t\t  }\n\n\t\t  braintree.hostedFields.create({\n\t\t    client: clientInstance,\n\t\t    styles: {\n\t\t      'input': {\n\t\t        'font-size': '14px',\n\t\t        'font-family': latepoint_helper.body_font_family,\n\t\t        'font-weight': '500',\n\t\t        'color': '#fff',\n\t\t      },\n\t\t      ':focus': {\n\t\t        'color': '#fff'\n\t\t      },\n\t\t      '::placeholder': {\n\t\t        'color': '#7d89b1'\n\t\t      },\n\t\t      '.valid': {\n\t\t        'color': '#fff'\n\t\t      },\n\t\t      '.invalid': {\n\t\t        'color': '#ff5a16'\n\t\t      }\n\t\t    },\n\t\t    fields: {\n\t\t      number: {\n\t\t        selector: '#payment_card_number',\n\t\t        placeholder: jQuery('#payment_card_number').data('placeholder')\n\t\t      },\n\t\t      cvv: {\n\t\t        selector: '#payment_card_cvc',\n\t\t        placeholder: jQuery('#payment_card_cvc').data('placeholder')\n\t\t      },\n\t\t      expirationDate: {\n\t\t        selector: '#payment_card_expiration',\n\t\t        placeholder: jQuery('#payment_card_expiration').data('placeholder')\n\t\t      },\n\t\t    }\n\t\t  }, function(err, hostedFieldsInstance) {\n\t\t  \tOsPaymentsBraintree.hostedFieldsInstance = hostedFieldsInstance;\n\t\t    if (err) {\n\t\t      console.error(err);\n\t\t      return;\n\t\t    }\n\t\t  });\n\t\t});\n\t}\n}","class OsPaymentsPaypal {\n\n\n  static create_paypal_button(button){\n  \tlet $booking_form_wrapper = jQuery(button).closest('.latepoint-booking-form-element');\n  \tvar payment_amount = latepoint_get_paypal_payment_amount($booking_form_wrapper);\n\n\t  paypal.Buttons({\n\t    createOrder: function(data, actions) {\n\t      return actions.order.create({\n\t        purchase_units: [{\n\t          amount: {\n\t            value: payment_amount,\n\t            currency_code: latepoint_helper.paypal_payment_currency,\n\t          },\n\t        }],\n\t        application_context: {\n\t\t        shipping_preference: 'NO_SHIPPING'\n\t        }\n\t      });\n\t    },\n\t    onApprove: function(data, actions) {\n\n\t\t\t\tjQuery($booking_form_wrapper).removeClass('step-content-loaded').addClass('step-content-loading');\n\t      // Authorize the transaction\n\t      actions.order.authorize().then(function(authorization) {\n\n\t        // Get the authorization id\n\t        var authorizationID = authorization.purchase_units[0].payments.authorizations[0].id\n          var orderID = data.orderID;\n\t        latepoint_set_payment_token_and_submit($booking_form_wrapper, authorizationID);\n\t      });\n\t    }\n\t  }).render(button);\n  }\n}"]}